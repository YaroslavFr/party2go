!function(m,u){"use strict";function l(t,i){return this.targets=u(t),this.settings=u.extend({},u.fn.tcToolTip.defaults,i),0<this.targets.length&&(this.init(),this)}var n;u(function(){n=m.TMEPOJS||{tm_epo_global_tooltip_max_width:"340px"}}),l.prototype={constructor:l,removeTooltip:function(t,i){var o=this.settings;t.data("is_moving")||(i.removeClass(o.fadin).addClass(o.fadeout),i.animate({opacity:0},o.speed,function(){u(this).remove()}),t.data("tmtip-title")&&void 0===t.data("tm-tip-html")&&!t.attr("data-tm-tooltip-html")&&t.attr("title",t.data("tmtip-title")),u(m).off("scroll.tcToolTip resize.tcToolTip"),o.onetime&&this.destroy())},initTooltip:function(t,i,o){var a,e,l,s,d=this.settings;t&&i&&1===t.length&&1===i.length&&1===t.data("tm-has-tm-tip")&&(1===o&&(s=void 0!==t.data("tm-tip-html")?t.data("tm-tip-html"):t.attr("data-tm-tooltip-html")?t.attr("data-tm-tooltip-html"):t.attr("title"),i.html(s),t.data("is_moving",!0)),i.find("aside").hide(),""===n.tm_epo_global_tooltip_max_width?u(m).width()<=1.2*i.outerWidth()?i.css("max-width",u(m).width()/1.2+"px"):i.css("max-width","340px"):(n.tm_epo_global_tooltip_max_width.isNumeric()&&(n.tm_epo_global_tooltip_max_width=n.tm_epo_global_tooltip_max_width+"px"),i.css("max-width",n.tm_epo_global_tooltip_max_width)),i.find("aside").show(),i.css({left:"",right:"",top:""}),l=u.epoAPI.dom.scroll(),(s=a=t.offset().left+t.outerWidth()/2-i.outerWidth()/2)<0?(a=t.offset().left+t.outerWidth()/2-20,i.addClass("left")):i.removeClass("left"),0<=s&&a+i.outerWidth()>u(m).width()?((a=t.offset().left-i.outerWidth()+t.outerWidth()/2+20)<0&&(a-=10,i.css("max-width","calc("+i.css("max-width")+" - "+Math.abs(a)+"px)"),a=10),i.addClass("right")):i.removeClass("right"),i.css({left:a,right:"auto",top:e}),e=t.offset().top-i.outerHeight()-10,l=t.offset().top-l.top-i.outerHeight()-10,e<0||l<0?(e=t.offset().top+t.outerHeight()+10,i.addClass("top"),i.removeClass("bottom")):(i.removeClass("top"),i.addClass("bottom")),u(m).trigger("tm_tooltip_show"),o?(i.css({left:a,top:e}),t.data("is_moving",!1)):i.css({left:a,top:e}).removeClass(d.fadeout).addClass(d.fadin))},show:function(t){var i,o=this.settings;if(!t.data("is_moving"))return 1===t.data("tm-has-tm-tip")&&(void 0!==t.data("tm-tip-html")?(i=t.data("tm-tip-html"),t.attr("title")&&t.data("tmtip-title",t.attr("title")),t.removeAttr("title")):t.attr("data-tm-tooltip-html")?(i=t.attr("data-tm-tooltip-html"),t.attr("title")&&t.data("tmtip-title",t.attr("title")),t.removeAttr("title")):i=t.attr("title"),void 0!==i&&(u("#tm-tooltip").remove(),o.tipclass?o.tipclass=" "+o.tipclass:o.tipclass="",(o=u('<div id="tm-tooltip" class="tm-tip tm-animated'+o.tipclass+'"></div>')).css("opacity",0).html(i).appendTo("body"),0<(i=o.find("img")).length&&i.on("load",this.initTooltip.bind(this,t,o)),this.initTooltip(t,o),u(m).on("scroll.tcToolTip resize.tcToolTip",this.initTooltip.bind(this,t,o)),t.data("is_moving",!1),t.on("tmmovetooltip",this.initTooltip.bind(this,t,o,1)),t.on("mouseleave.tc tmhidetooltip",this.removeTooltip.bind(this,t,o)),t.closest("label").on("mouseleave.tc tmhidetooltip",this.removeTooltip.bind(this,t,o)),o.on("click",this.removeTooltip.bind(this,t,o)))),!1},destroy:function(){0<this.targets.length&&(this.targets.toArray().forEach(function(t){t=u(t);t.closest("off").on("mouseleave.tc tmhidetooltip"),t.off("tc-tooltip-html-changed tmmovetooltip tmhidetooltip mouseenter.tc mouseleave.tc tmshowtooltip.tc"),t.removeData("tmtip-title"),t.removeData("tm-tip-html")}),this.targets.removeData("tctooltip tm-has-tm-tip is_moving"))},init:function(){var f=this,g=this.settings;0<this.targets.length&&this.targets.toArray().forEach(function(t){var i,o,a,e,l,s,d,m,n,r,h,p=u(t),c=g.tip||void 0;void 0===p.data("tm-has-tm-tip")&&(i=p.attr("data-tm-tooltip-swatch"),o=p.attr("data-tm-tooltip-swatch-desc"),a=p.attr("data-tm-tooltip-swatch-lbl-desc"),e=p.attr("data-tm-tooltip-swatch-img"),l=p.attr("data-tm-tooltip-swatch-img-lbl"),s=p.attr("data-tm-tooltip-swatch-img-desc"),d=p.attr("data-tm-tooltip-swatch-img-lbl-desc"),p.data("tm-has-tm-tip",1),n=void 0!==p.attr("data-original")?p.attr("data-original"):void 0!==p.attr("src")?p.attr("src"):p[0].src,0===(r=0===(r=0===(r=(m=0===(m=0===(m=(m=p.closest(".tmcp-field-wrap")).is(".tc-epo-element-product-holder")?p.closest(".cpf-element"):m).length?p.closest(".cpf-element"):m).length?p.closest(".cpf-section").find(".tc-section-inner-wrap .tm-section-description.tm-description"):m).find(".tm-tip-html")).length?m.find(".checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline"):r).length?m.next(".checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline,.tm-tip-html"):r).length&&m.is(".tm-description")&&(r=m),r=u(m=r),h="yes"===p.attr("data-tm-hide-label")||void 0===p.attr("data-tm-hide-label")||r.is(".tm-tip-html"),t="",0===(m=(m=p.closest(".tmcp-field-wrap")).find("[data-tm-tooltip-html]")).length?0<(m=p.closest(".tmcp-field-wrap").find(".tc-inline-description")).length&&(t=m.html()):t=m.attr("data-tm-tooltip-html"),void 0===c?(i?c=r.html():o?c="<aside>"+t+"</aside>":a?c="<aside>"+r.html()+"</aside><aside>"+t+"</aside>":e?c='<img src="'+n+'">':l?c='<img src="'+n+'"><aside>'+r.html()+"</aside>":s?c='<img src="'+n+'"><aside>'+t+"</aside>":d&&(c='<img src="'+n+'"><aside>'+r.html()+"</aside><aside>"+t+"</aside>"),void 0!==c&&(p.data("tm-tip-html",c),h&&r.hide()),c=p.attr("data-tm-tooltip-html")?p.attr("data-tm-tooltip-html"):p.attr("title")):p.data("tm-tip-html",c),p.on("tc-tooltip-html-changed",function(){p.attr("data-tm-tooltip-html")?p.show():p.hide()}),p.closest("label").on("mouseenter tmshowtooltip",f.show.bind(f,p)),p.on("mouseenter.tc tmshowtooltip.tc",f.show.bind(f,p)),g.trigger&&f.show(p))})}},u.fn.tcToolTip=function(t){var i,o,a=u(this),e="object"==typeof t?t:{};return a.map(function(){return u(this).data("tctooltip")||""}).get().some(function(t){return""===t})&&(o=new l(this,e),a.data("tctooltip",o)),void 0===(i="string"==typeof t?(o=a.data("tctooltip"))[t].apply(o,[]):i)?a:i},u.fn.tcToolTip.defaults={fadin:"fadein",fadeout:"fadeout",speed:1500},u.fn.tcToolTip.instances=[],u.fn.tcToolTip.Constructor=l,u.tcToolTip=function(t,i){var o=!1;return(t=t||u(".tm-tooltip")).map(function(){return u(this).data("tctooltip")||""}).get().some(function(t){return""===t})&&(o=new l(t,i),t.data("tctooltip",o)),o}}(window,window.jQuery);