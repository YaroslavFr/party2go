!function(p){"use strict";var v=p.epoAPI.util.getStorage("localStorage"),o=window.confirm;p.fn.tcTabs=function(b){var h,f=[],u=[];if(0!==this.length)return b=p.extend({headers:".tm-tab-headers",header:".tab-header",addheader:".tm-add-tab",classdown:"tcfa-angle-down",classup:"tcfa-angle-up",animationclass:"appear",dataattribute:"data-id",dataopenattribute:"data-id",selectedtab:"auto",showonhover:!1,useclasstohide:!0,afteraddtab:null,beforemovetab:null,aftermovetab:null,deletebutton:!1,deletebuttonhtml:'<h4 class="tm-del-tab"><span class="tcfa tcfa-times"></span></h4>',deleteheader:".tm-del-tab",deleteconfirm:!1,beforedeletetab:null,afterdeletetab:null},b),h=function(a,e,s,t){var d="";t.on("closetab.tmtabs",function(){var t=a.find(p(this).data("tab"));p(this).removeClass("closed open").addClass("closed"),p(this).find(".tm-arrow").removeClass(b.classdown+" "+b.classup).addClass(b.classdown),b.useclasstohide?t.addClass("tm-hide").removeClass("tm-show"):t.hide(),t.removeClass("tm-animated "+b.animationclass),p(window).trigger("tc-closetab.tmtabs",{header:p(this),tab:t})}),t.on("opentab.tmtabs",function(){var t=a.find(p(this).data("tab"));p(this).removeClass("closed open").addClass("open"),p(this).find(".tm-arrow").removeClass(b.classdown+" "+b.classup).addClass(b.classup),b.useclasstohide?t.removeClass("tm-hide").addClass("tm-show"):t.show(),t.removeClass("tm-animated "+b.animationclass).addClass("tm-animated "+b.animationclass),u[e]=p(this).data("tab"),p(window).trigger("tc-opentab.tmtabs",{header:p(this),tab:u[e],table:t})}),!0!==b.showonhover&&"function"!=typeof b.showonhover||(d=" mouseover"),t.on("keydown.tmtabs",function(t){var e,a=p(this);13===t.keyCode&&p(this).trigger("click.tmtabs"),40===t.keyCode&&(e=p(this).closest(".tm-box").next().find(b.header)),(e=38===t.keyCode?p(this).closest(".tm-box").prev().find(b.header):e)&&e.length&&(a.trigger("blur"),e.trigger(" focus").trigger("click"),t.preventDefault())}),t.on("click.tmtabs"+d,function(t){t.preventDefault(),"mouseover"===t.type&&"function"==typeof b.showonhover&&!b.showonhover.call()||(u[e]!==p(this).data("tab")?(f[e]&&p(f[e]).trigger("closetab.tmtabs"),p(this).trigger("opentab.tmtabs"),f[e]=p(this),v&&v.setItem("tmadmintab-"+s,p(this).attr(b.dataopenattribute)),p(window).trigger("tc-tmtabs-clicked",{tc:s,options:b,header:p(this),tab:u[e],table:a.find(u[e])})):p(window).trigger("tc-isopentab.tmtabs",{header:p(this),tab:u[e],table:a.find(u[e])}))}),b.deletebutton&&(t.after(b.deletebuttonhtml),t.closest(".tm-box").find(b.deleteheader).on("click.tmtabs",function(){var t,e;a.find(b.headers+" "+b.header).length<2||b.deleteconfirm&&!o(window.TMEPOGLOBALADMINJS.i18n_builder_delete)||(t=p(this),e=a.find("."+t.closest(".tm-box").find(b.header).attr(b.dataattribute)),"function"==typeof b.beforedeletetab&&b.beforedeletetab.call(a,t,e),e.remove(),t.closest(".tm-box").remove(),"function"==typeof b.afterdeletetab&&b.afterdeletetab.call(a))}))},this.each(function(n){var t,o,r=p(this),l=r.attr("class"),e=r.find(b.headers+" "+b.header),i=0,c="",s=0,m=0,d={};0!==e.length&&(window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,e,a){d[e]=a}),f[n]=!1,u[n]="",r.data("tm-has-tmtabs",1),e.each(function(t,e){var a="."+(e=p(e)).attr(b.dataattribute);e.data("tab",a),b.useclasstohide?r.find(a).addClass("tm-hide").removeClass("tm-show"):r.find(a).hide(),r.find(a).data("state","closed"),!s&&e.is(".open")?(e.removeClass("closed open").addClass("open").data("state","open"),e.find(".tm-arrow").removeClass(b.classdown+" "+b.classup).addClass(b.classup),b.useclasstohide?r.find(a).removeClass("tm-hide").addClass("tm-show"):r.find(a).show(),r.find(a).data("state","open"),s=1,u[n]=a,f[n]=e):e.removeClass("closed open").addClass("closed").data("state","closed"),h(r,n,l,e)}),r.find(b.headers+":not(.section_elements "+b.headers+",.tm-settings-wrap "+b.headers+",.builder-element-wrap "+b.headers+")").sortable({containment:"parent",cursor:"move",items:".tm-box:not(.tm-add-box)",start:function(t,e){var a=r.find("."+e.item.closest(".tm-box").find(b.header).attr(b.dataattribute));i=e.item.index(),c=e.item.find(b.header).attr("data-id"),o=p.tmEPOAdmin.find_index(!0,a.find(".bitem").first()),"function"==typeof b.beforemovetab&&b.beforemovetab.call(this,i,a,o)},stop:function(t,e){var a,s=r.find(b.headers+" "+b.header),d=r.find("."+e.item.closest(".tm-box").find(b.header).attr(b.dataattribute));s.each(function(t){p(this).html(parseInt(t,10)+1)}),a=r.find(".tm-slider-wizard-tab."+c),e=r.find(b.headers+" "+b.header+"[data-id='"+c+"']").parent().index(),s=r.find(".tm-slider-wizard-tab").eq(e),i<e?s.after(a):e<i&&s.before(a),"function"==typeof b.aftermovetab&&b.aftermovetab.call(this,e,i,d,o)},cancel:".tm-add-box",forcePlaceholderSize:!0,revert:200,placeholder:"tm-box pl",tolerance:"pointer"}),r.find(b.addheader).on("click.tmtabs",function(t){var e=r.find(b.headers+" "+b.header).last(),a=e.attr(b.dataattribute),s=r.find("."+a),d=e.tcClone().off("closetab.tmtabs opentab.tmtabs click.tmtabs"),o=s.tcClone().empty(),i=a+"-"+m;t.preventDefault(),m+=1,d.html(r.find(b.headers+" "+b.header).length+1).removeClass("closed open").addClass("closed").data("tab","."+i).data("state","closed").attr(b.dataattribute,i),o.removeClass(a).addClass(i),b.useclasstohide?o.addClass("tm-hide").removeClass(".tm-show"):o.hide(),o.removeClass("tm-animated "+b.animationclass),e.closest(".tm-box").after(d),d.wrap('<div class="tm-box"></div>'),h(r,n,l,d),s.after(o),"function"==typeof b.afteraddtab&&b.afteraddtab.call(this,d,o)}),"auto"===b.selectedtab?(v&&(t=v.getItem("tmadmintab-"+l)),null==(t=void 0!==d.selected_tab?d.selected_tab:t)&&(t=p(b.header).eq(0).attr(b.dataopenattribute)),(p(b.header+"["+b.dataopenattribute+'="'+t+'"]').is(":visible")?p(b.header+"["+b.dataopenattribute+'="'+t+'"]'):p(b.header).eq(0)).trigger("click.tmtabs")):!1!==b.selectedtab&&(t=parseInt(b.selectedtab,10),r.find(b.header+":eq("+t+")").trigger("click.tmtabs")))})},p.fn.tmtabs=p.fn.tcTabs}(window.jQuery);